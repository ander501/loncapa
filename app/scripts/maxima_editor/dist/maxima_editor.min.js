(function(){function f(){this.operators=[]}f.ARG_SEPARATOR=";";f.DECIMAL_SIGN_1=".";f.DECIMAL_SIGN_2=",";f.prototype.operator=function(n,l,k,j,i,m){this.operators.push(new d(n,l,k,j,i,m))};f.prototype.separator=function(i){this.operator(i,d.BINARY,0,0,null,null)};f.prototype.infix=function(n,k,j,m){var l,i;l=d.BINARY;i=null;m=m||function(r,q){var o=[q,r.expression(j)];return new h(h.OPERATOR,this,n,o)};this.operator(n,l,k,j,i,m)};f.prototype.prefix=function(n,j,i){var l,k,m;l=d.UNARY;k=0;i=i||function(q){var o=[q.expression(j)];return new h(h.OPERATOR,this,n,o)};m=null;this.operator(n,l,k,j,i,m)};f.prototype.suffix=function(n,k,m){var l,j,i;l=d.UNARY;j=0;i=null;m=m||function(r,q){var o=[q];return new h(h.OPERATOR,this,n,o)};this.operator(n,l,k,j,i,m)};f.prototype.define=function(){this.suffix("!",160);this.infix("^",140,139);this.infix("*",120,120);this.infix("/",120,120);this.infix("+",100,100);this.operator("-",d.BINARY,100,134,function(j){var i=[j.expression(134)];return new h(h.OPERATOR,this,"-",i)},function(k,j){var i=[j,k.expression(100)];return new h(h.OPERATOR,this,"-",i)});this.infix("=",80,80);this.infix("#",80,80);this.infix("<=",80,80);this.infix(">=",80,80);this.infix("<",80,80);this.infix(">",80,80);this.separator(")");this.separator(f.ARG_SEPARATOR);this.operator("(",d.BINARY,200,200,function(j){var i=j.expression(0);j.advance(")");return i},function(k,j){if(j.type!=h.NAME){throw new a("Function name expected before a parenthesis.",k.tokens[k.token_nr-1].from)}var i=[];if(k.current_token==null||k.current_token.op==null||k.current_token.op.id!==")"){while(true){i.push(k.expression(0));if(k.current_token==null||k.current_token.op==null||k.current_token.op.id!==f.ARG_SEPARATOR){break}k.advance(f.ARG_SEPARATOR)}}k.advance(")");return new h(h.FUNCTION,this,j.value,i)});this.separator("]");this.prefix("[",70,function(j){var i=[];if(j.current_token==null||j.current_token.op==null||j.current_token.op.id!=="]"){while(true){i.push(j.expression(0));if(j.current_token==null||j.current_token.op==null||j.current_token.op.id!==f.ARG_SEPARATOR){break}j.advance(f.ARG_SEPARATOR)}}j.advance("]");return new h(h.VECTOR,this,null,i)})};function h(j,l,k,i){this.type=j;this.op=l;this.value=k;this.children=i}h.UNKNOWN=0;h.NAME=1;h.NUMBER=2;h.OPERATOR=3;h.FUNCTION=4;h.VECTOR=5;h.prototype.toString=function(){var k="(";switch(this.type){case h.UNKNOWN:k+="UNKNOWN";break;case h.NAME:k+="NAME";break;case h.NUMBER:k+="NUMBER";break;case h.OPERATOR:k+="OPERATOR";break;case h.FUNCTION:k+="FUNCTION";break;case h.VECTOR:k+="VECTOR";break}if(this.op){k+=" '"+this.op.id+"'"}if(this.value){k+=" '"+this.value+"'"}if(this.children){k+=" [";for(var j=0;j<this.children.length;j++){k+=this.children[j].toString();if(j!=this.children.length-1){k+=","}}k+="]"}k+=")";return k};h.prototype.toMathML=function(){var B,z,x,w,E,C,l,u,v,D,n,s;if(this.children!=null&&this.children.length>0){B=this.children[0]}else{B=null}if(this.children!=null&&this.children.length>1){z=this.children[1]}else{z=null}if(this.children!=null&&this.children.length>2){x=this.children[2]}else{x=null}if(this.children!=null&&this.children.length>3){w=this.children[3]}else{w=null}switch(this.type){case h.UNKNOWN:l=document.createElement("mtext");l.appendChild(document.createTextNode("???"));return(l);case h.NAME:return(this.mi(this.value));case h.NUMBER:l=document.createElement("mn");l.appendChild(document.createTextNode(this.value));return(l);case h.OPERATOR:if(this.value=="/"){s=document.createElement("mfrac");s.appendChild(B.toMathML());s.appendChild(z.toMathML());l=s}else{if(this.value=="^"){if(B.type==h.FUNCTION){if(B.value=="sqrt"||B.value=="abs"||B.value=="matrix"||B.value=="diff"){u=false}else{u=true}}else{if(B.type==h.OPERATOR){u=true}else{u=false}}l=document.createElement("msup");if(u){l.appendChild(this.addP(B))}else{l.appendChild(B.toMathML())}l.appendChild(z.toMathML())}else{if(this.value=="*"){v=document.createElement("mrow");if(B.type==h.OPERATION&&(B.value=="+"||B.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}var F=z;while(F.type==h.OPERATION){F=F.children[0]}if(F.type==h.NUMBER){v.appendChild(this.mo("\u22C5"))}if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(z))}else{v.appendChild(z.toMathML())}l=v}else{if(this.value=="-"){v=document.createElement("mrow");if(this.children.length==1){v.appendChild(this.mo("-"));v.appendChild(B.toMathML())}else{v.appendChild(B.toMathML());v.appendChild(this.mo("-"));if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(z))}else{v.appendChild(z.toMathML())}}l=v}else{if(this.value=="!"){v=document.createElement("mrow");D=this.mo(this.value);if(B.type==h.OPERATOR&&(B.value=="+"||B.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}v.appendChild(D);l=v}else{if(this.value=="+"){v=document.createElement("mrow");D=this.mo(this.value);v.appendChild(B.toMathML());v.appendChild(D);u=false;var q=z;while(q.type==h.OPERATOR){if(q.value=="-"&&q.children.length==1){u=true;break}else{if(q.value=="+"||q.value=="-"||q.value=="*"){q=q.children[0]}else{break}}}if(u){v.appendChild(this.addP(z))}else{v.appendChild(z.toMathML())}l=v}else{v=document.createElement("mrow");D=this.mo(this.value);v.appendChild(B.toMathML());v.appendChild(D);v.appendChild(z.toMathML());l=v}}}}}}return(l);case h.FUNCTION:if(this.value=="sqrt"&&B!=null){l=document.createElement("msqrt");l.appendChild(B.toMathML())}else{if(this.value=="abs"&&B!=null){v=document.createElement("mrow");v.appendChild(this.mo("|"));v.appendChild(B.toMathML());v.appendChild(this.mo("|"));l=v}else{if(this.value=="exp"&&B!=null){l=document.createElement("msup");l.appendChild(this.mi("e"));l.appendChild(B.toMathML())}else{if(this.value=="factorial"){v=document.createElement("mrow");D=this.mo("!");if(B.type==h.OPERATOR&&(B.value=="+"||B.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}v.appendChild(D);l=v}else{if(this.value=="diff"&&this.children!=null&&this.children.length==2){v=document.createElement("mrow");s=document.createElement("mfrac");s.appendChild(this.mi("d"));var A=document.createElement("mrow");A.appendChild(this.mi("d"));A.appendChild(this.mi(z.value));s.appendChild(A);v.appendChild(s);if(B.type==h.OPERATOR&&(B.value=="+"||B.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}l=v}else{if(this.value=="diff"&&this.children!=null&&this.children.length==3){v=document.createElement("mrow");s=document.createElement("mfrac");var p=document.createElement("msup");p.appendChild(this.mi("d"));p.appendChild(x.toMathML());s.appendChild(p);var A=document.createElement("mrow");A.appendChild(this.mi("d"));p=document.createElement("msup");p.appendChild(z.toMathML());p.appendChild(x.toMathML());A.appendChild(p);s.appendChild(A);v.appendChild(s);if(B.type==h.OPERATOR&&(B.value=="+"||B.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}l=v}else{if(this.value=="integrate"&&this.children!=null&&this.children.length==2){v=document.createElement("mrow");var D=this.mo("\u222B");D.setAttribute("stretchy","true");v.appendChild(D);if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}v.appendChild(this.mi("d"));v.appendChild(z.toMathML());l=v}else{if(this.value=="integrate"&&this.children!=null&&this.children.length==4){v=document.createElement("mrow");var t=document.createElement("msubsup");var D=this.mo("\u222B");D.setAttribute("stretchy","true");t.appendChild(D);t.appendChild(x.toMathML());t.appendChild(w.toMathML());v.appendChild(t);if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}v.appendChild(this.mi("d"));v.appendChild(z.toMathML());l=v}else{if(this.value=="sum"&&this.children!=null&&this.children.length==4){v=document.createElement("mrow");var o=document.createElement("munderover");var D=this.mo("\u2211");D.setAttribute("stretchy","true");o.appendChild(D);var k=document.createElement("mrow");k.appendChild(z.toMathML());k.appendChild(this.mo("="));k.appendChild(x.toMathML());o.appendChild(k);o.appendChild(w.toMathML());v.appendChild(o);if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}l=v}else{if(this.value=="product"&&this.children!=null&&this.children.length==4){v=document.createElement("mrow");var o=document.createElement("munderover");var D=this.mo("\u220F");D.setAttribute("stretchy","true");o.appendChild(D);var k=document.createElement("mrow");k.appendChild(z.toMathML());k.appendChild(this.mo("="));k.appendChild(x.toMathML());o.appendChild(k);o.appendChild(w.toMathML());v.appendChild(o);if(z.type==h.OPERATOR&&(z.value=="+"||z.value=="-")){v.appendChild(this.addP(B))}else{v.appendChild(B.toMathML())}l=v}else{if(this.value=="limit"){v=document.createElement("mrow");if(this.children.length<3){v.appendChild(this.mo("lim"))}else{var m=document.createElement("munder");m.appendChild(this.mo("lim"));var y=document.createElement("mrow");y.appendChild(z.toMathML());y.appendChild(this.mo("\u2192"));y.appendChild(x.toMathML());if(w!=null){if(w.value=="plus"){y.appendChild(this.mo("+"))}else{if(w.value=="minus"){y.appendChild(this.mo("-"))}}}m.appendChild(y);v.appendChild(m)}v.appendChild(B.toMathML());l=v}else{if(this.value=="binomial"){v=document.createElement("mrow");v.appendChild(this.mo("("));n=document.createElement("mtable");for(E=0;E<this.children.length;E++){var r=document.createElement("mtr");r.appendChild(this.children[E].toMathML());n.appendChild(r)}v.appendChild(n);v.appendChild(this.mo(")"));l=v}else{if(this.value=="matrix"){for(E=0;E<this.children.length;E++){if(this.children[E].type!==h.VECTOR){l=document.createElement("mtext");l.appendChild(document.createTextNode("???"));return(l)}}v=document.createElement("mrow");v.appendChild(this.mo("("));n=document.createElement("mtable");for(E=0;E<this.children.length;E++){var r=document.createElement("mtr");for(C=0;C<this.children[E].children.length;C++){r.appendChild(this.children[E].children[C].toMathML())}n.appendChild(r)}v.appendChild(n);v.appendChild(this.mo(")"));l=v}else{v=document.createElement("mrow");v.appendChild(this.mi(this.value));v.appendChild(this.mo("("));for(E=0;E<this.children.length;E++){v.appendChild(this.children[E].toMathML());if(E<this.children.length-1){v.appendChild(this.mo(f.ARG_SEPARATOR))}}v.appendChild(this.mo(")"));l=v}}}}}}}}}}}}}return(l);case h.VECTOR:v=document.createElement("mrow");v.appendChild(this.mo("("));n=document.createElement("mtable");for(E=0;E<this.children.length;E++){var r=document.createElement("mtr");r.appendChild(this.children[E].toMathML());n.appendChild(r)}v.appendChild(n);v.appendChild(this.mo(")"));return(v)}};h.prototype.mi=function(j){var i=document.createElement("mi");if(h.symbols[j]){j=h.symbols[j]}i.appendChild(document.createTextNode(j));return i};h.prototype.mo=function(i){var j=document.createElement("mo");if(h.symbols[i]){i=h.symbols[i]}j.appendChild(document.createTextNode(i));return j};h.prototype.addP=function(j){var i=document.createElement("mrow");i.appendChild(this.mo("("));i.appendChild(j.toMathML());i.appendChild(this.mo(")"));return i};h.symbols={alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9","#":"\u2260",">=":"\u2265","<=":"\u2264",inf:"\u221E",minf:"-\u221E"};function d(n,l,k,j,i,m){this.id=n;this.arity=l;this.lbp=k;this.rbp=j;this.nud=i;this.led=m}d.UNKNOWN=0;d.UNARY=1;d.BINARY=2;d.TERNARY=3;function a(i,k,j){this.msg=i;this.from=k;if(j){this.to=j}else{this.to=this.from}}a.prototype.toString=function(){return(this.msg+" at "+this.from+" - "+this.to)};function e(){this.defs=new f();this.defs.define();this.operators=this.defs.operators;this.oph={};for(var j=0;j<this.operators.length;j++){this.oph[this.operators[j].id]=this.operators[j]}}e.prototype.expression=function(i){var k;var j=this.current_token;if(j==null){throw new a("Expected something at the end",this.tokens[this.tokens.length-1].to+1)}this.advance();if(j.op==null){k=new h(j.type,null,j.value,null)}else{if(j.op.nud==null){throw new a("Unexpected operator '"+j.op.id+"'",j.from)}else{k=j.op.nud(this)}}while(this.current_token!=null&&this.current_token.op!=null&&i<this.current_token.op.lbp){j=this.current_token;this.advance();k=j.op.led(this,k)}return k};e.prototype.advance=function(i){if(i&&(this.current_token==null||this.current_token.op==null||this.current_token.op.id!==i)){if(this.current_token==null){throw new a("Expected '"+i+"' at the end",this.tokens[this.tokens.length-1].to+1)}else{throw new a("Expected '"+i+"'",this.current_token.from)}}if(this.token_nr>=this.tokens.length){this.current_token=null;return}this.current_token=this.tokens[this.token_nr];this.token_nr+=1};e.prototype.parse=function(k){var j=new c(this.defs,k);this.tokens=j.tokenize();if(this.tokens.length==0){return null}this.token_nr=0;this.current_token=this.tokens[this.token_nr];this.advance();var i=this.expression(0);if(this.current_token!=null){throw new a("Expected the end",this.current_token.from)}return i};function g(i,m,l,j,k){this.type=i;this.from=m;this.to=l;this.value=j;this.op=k}g.UNKNOWN=0;g.NAME=1;g.NUMBER=2;g.OPERATOR=3;function c(i,j){this.defs=i;this.text=j}c.prototype.tokenize=function(){var r,j,m,q,l,k;j=0;r=this.text.charAt(j);l=[];main:while(r){q=j;if(r<=" "){j++;r=this.text.charAt(j);continue}for(m=0;m<this.defs.operators.length;m++){var p=this.defs.operators[m];if(this.text.substring(j,j+p.id.length)===p.id){j+=p.id.length;r=this.text.charAt(j);l.push(new g(g.OPERATOR,q,j-1,p.id,p));continue main}}if((r>="a"&&r<="z")||(r>="A"&&r<="Z")){k=r;j++;for(;;){r=this.text.charAt(j);if((r>="a"&&r<="z")||(r>="A"&&r<="Z")||(r>="0"&&r<="9")||r==="_"){k+=r;j++}else{break}}l.push(new g(g.NAME,q,j-1,k,null))}else{if((r>="0"&&r<="9")||r===f.DECIMAL_SIGN_1||r===f.DECIMAL_SIGN_2){k="";if(r!==f.DECIMAL_SIGN_1&&r!==f.DECIMAL_SIGN_2){j++;k+=r;for(;;){r=this.text.charAt(j);if(r<"0"||r>"9"){break}j++;k+=r}}if(r===f.DECIMAL_SIGN_1||r===f.DECIMAL_SIGN_2){j++;k+=r;for(;;){r=this.text.charAt(j);if(r<"0"||r>"9"){break}j+=1;k+=r}}if(r==="e"||r==="E"){j++;k+=r;r=this.text.charAt(j);if(r==="-"||r==="+"){j++;k+=r;r=this.text.charAt(j)}if(r<"0"||r>"9"){throw new a("syntax error in number exponent",q,j)}do{j++;k+=r;r=this.text.charAt(j)}while(r>="0"&&r<="9")}if((r>="a"&&r<="z")||(r>="A"&&r<="Z")){throw new a("syntax error in number",q,j)}var o=+k.replace(f.DECIMAL_SIGN_1,".").replace(f.DECIMAL_SIGN_2,".");if(isFinite(o)){l.push(new g(g.NUMBER,q,j-1,k,null))}else{throw new a("syntax error in number",q,j)}}else{throw new a("unrecognized operator",q,j)}}}return l};var b=function(l){var m,k,n,i,j,p;m=l.ta;k=l.output_div;n=m.value;if(n!=l.oldtxt){l.oldtxt=n;while(k.firstChild!=null){k.removeChild(k.firstChild)}k.removeAttribute("title");if(n!=""){i=new e();try{p=i.parse(n);if(p!=null){var q=document.createElement("math");q.setAttribute("display","block");q.appendChild(p.toMathML());k.appendChild(q);MathJax.Hub.Queue(["Typeset",MathJax.Hub,k])}}catch(o){j="error: "+o;k.setAttribute("title",j);if(o instanceof a){k.appendChild(document.createTextNode(n.substring(0,o.from)));var r=document.createElement("span");r.appendChild(document.createTextNode(n.substring(o.from,o.to+1)));r.className="error";k.appendChild(r);if(o.to<n.length-1){k.appendChild(document.createTextNode(n.substring(o.to+1)))}}else{var s=document.createTextNode(j);k.appendChild(s)}}}}};window.addEventListener("load",function(n){var q=[];var o=document.getElementsByClassName("maxima");for(var l=0;l<o.length;l++){var m=o[l];var k=document.createElement("div");if(m.nextSibling){m.parentNode.insertBefore(k,m.nextSibling)}else{m.parentNode.appendChild(k)}var r="";q[l]={ta:m,output_div:k,oldtxt:r};var j=function(i){return function(s){b(q[i])}};var p=j(l);if(m.value!=r){p()}m.addEventListener("change",p,false);m.addEventListener("keyup",p,false)}},false)}());